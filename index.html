<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CinePremium - TMDB Experience</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: #000;
            color: #fff;
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .dynamic-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: -1;
            overflow: hidden;
        }

        #bg-canvas-layer {
            position: absolute;
            inset: -10%; 
            width: 120%;
            height: 120%;
            filter: blur(100px) saturate(1.8);
            opacity: 0.5;
            transition: background 1.5s ease;
        }

        .gradient-overlay {
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 50% 30%, transparent, #000 90%);
            z-index: 1;
        }

        .app-container {
            position: relative;
            z-index: 10;
            max-width: 500px;
            margin: 0 auto;
            min-height: 100vh;
            padding-bottom: 120px;
        }

        /* HEADER ESTILIZADO */
        .header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* FILTROS COM BORDAS BRANCAS E FUNDO TRANSPARENTE */
        .filter-pill {
            padding: 8px 20px;
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.03); /* Quase transparente */
            backdrop-filter: blur(15px);
            font-size: 13px;
            font-weight: 500;
            border: 1px solid rgba(255, 255, 255, 0.5); /* Bordas brancas nítidas */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            color: #fff;
        }

        .filter-pill.active {
            background: #fff;
            color: #000;
            border-color: #fff;
        }

        .hero {
            position: relative;
            margin: 0 20px;
            height: 65vh;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.8);
            transition: transform 0.4s ease;
        }

        .hero img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: opacity 0.5s ease;
        }

        .hero-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 40px 20px;
            background: linear-gradient(to top, rgba(0,0,0,1) 10%, rgba(0,0,0,0.8) 30%, transparent);
        }

        .btn-main {
            padding: 14px;
            border-radius: 8px;
            font-weight: 800;
            font-size: 15px;
            transition: all 0.2s;
        }
        
        .btn-main:active {
            transform: scale(0.95);
        }

        .nav-bar {
            position: fixed;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 400px;
            background: rgba(15, 15, 15, 0.8);
            backdrop-filter: blur(30px);
            border-radius: 20px;
            padding: 15px;
            display: flex;
            justify-content: space-around;
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 100;
        }

        .movie-card {
            min-width: 130px; 
            aspect-ratio: 2/3;
            border-radius: 8px;
            background-color: #111;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .movie-card:active {
            transform: scale(0.95);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .skeleton {
            background: linear-gradient(90deg, #111 25%, #222 50%, #111 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body>

    <div class="dynamic-wrapper">
        <div id="bg-canvas-layer"></div>
        <div class="gradient-overlay"></div>
    </div>

    <div class="app-container">
        <!-- HEADER COM BUSCA E CHROMECAST -->
        <header class="header">
            <div>
                <h2 class="text-2xl font-extrabold tracking-tight">CinePremium</h2>
            </div>
            <div class="header-actions">
                <!-- Ícone Chromecast -->
                <button class="text-white opacity-80 active:opacity-100">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6"/><path d="M2 20h.01"/></svg>
                </button>
                <!-- Botão Busca -->
                <button class="text-white opacity-80 active:opacity-100">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                </button>
                <!-- Avatar -->
                <div class="w-8 h-8 rounded-full border border-white/20 overflow-hidden ml-1">
                    <img src="https://i.pravatar.cc/100?u=cine" alt="User">
                </div>
            </div>
        </header>

        <!-- FILTROS COM DESIGN SOLICITADO -->
        <div class="flex gap-3 px-5 mb-6 overflow-x-auto no-scrollbar">
            <button class="filter-pill active" onclick="loadCategory('trending')">Tendências</button>
            <button class="filter-pill" onclick="loadCategory('movie')">Filmes</button>
            <button class="filter-pill" onclick="loadCategory('tv')">Séries</button>
            <button class="filter-pill" onclick="loadCategory('trending')">Animes</button>
        </div>

        <!-- HERO PRINCIPAL -->
        <div class="hero" id="hero-container">
            <img id="main-poster" src="" crossorigin="anonymous" alt="Poster" class="opacity-0">
            <div class="hero-info">
                <span id="hero-tag" class="text-[10px] font-bold uppercase tracking-widest bg-white text-black px-2 py-1 rounded mb-3 inline-block">Destaque</span>
                <h1 id="hero-title" class="text-3xl font-black mb-1 leading-tight">Carregando...</h1>
                <p id="hero-meta" class="text-xs text-gray-400 mb-6 font-medium">Aguarde um momento</p>
                
                <div class="flex gap-3">
                    <button class="btn-main bg-white text-black flex-1 flex items-center justify-center gap-2">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="m7 4 12 8-12 8V4z"/></svg>
                        Assistir
                    </button>
                    <button class="btn-main bg-white/10 backdrop-blur-md text-white px-6 border border-white/10">
                        <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- SEÇÕES DINÂMICAS -->
        <div class="mt-10 px-5">
            <h3 class="text-lg font-bold mb-4 flex justify-between items-center">
                <span>Filmes em Alta</span>
                <span class="text-xs text-gray-500 font-medium">Ver tudo</span>
            </h3>
            <div id="movies-list" class="flex gap-4 overflow-x-auto no-scrollbar pb-4">
                <!-- Cards injetados via JS -->
            </div>
        </div>

        <div class="mt-6 px-5">
            <h3 class="text-lg font-bold mb-4 flex justify-between items-center">
                <span>Séries Recomendadas</span>
            </h3>
            <div id="series-list" class="flex gap-4 overflow-x-auto no-scrollbar pb-4">
                <!-- Cards injetados via JS -->
            </div>
        </div>
    </div>

    <!-- NAVEGAÇÃO -->
    <nav class="nav-bar">
        <button class="text-white"><svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg></button>
        <button class="text-gray-500"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg></button>
        <button class="text-gray-500"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"/></svg></button>
        <button class="text-gray-500"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 8v4l3 3"/></svg></button>
    </nav>

    <script>
        const API_KEY = '741fd22ccd6cebe13c498c8efc5c1576';
        const BASE_URL = 'https://api.themoviedb.org/3';
        const IMG_URL = 'https://image.tmdb.org/t/p/w780';
        const THUMB_URL = 'https://image.tmdb.org/t/p/w342';

        const posterEl = document.getElementById('main-poster');
        const bgLayer = document.getElementById('bg-canvas-layer');
        const titleEl = document.getElementById('hero-title');
        const metaEl = document.getElementById('hero-meta');
        const moviesContainer = document.getElementById('movies-list');
        const seriesContainer = document.getElementById('series-list');

        async function fetchTMDB(endpoint, retries = 5, delay = 1000) {
            try {
                const response = await fetch(`${BASE_URL}${endpoint}${endpoint.includes('?') ? '&' : '?'}api_key=${API_KEY}&language=pt-BR`);
                if (!response.ok) throw new Error('Falha na API');
                return await response.json();
            } catch (err) {
                if (retries > 0) {
                    await new Promise(res => setTimeout(res, delay));
                    return fetchTMDB(endpoint, retries - 1, delay * 2);
                }
                return null;
            }
        }

        function updateThemeColor(imgElement) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 10;
            canvas.height = 10;
            
            try {
                ctx.drawImage(imgElement, 0, 0, 10, 10);
                const data = ctx.getImageData(0, 0, 10, 10).data;
                let r = 0, g = 0, b = 0;
                for (let i = 0; i < data.length; i += 4) {
                    r += data[i]; g += data[i+1]; b += data[i+2];
                }
                const count = data.length / 4;
                bgLayer.style.background = `rgb(${Math.floor(r/count)}, ${Math.floor(g/count)}, ${Math.floor(b/count)})`;
            } catch (e) {
                bgLayer.style.background = '#1a1a1a';
            }
        }

        function setHero(item) {
            const isMovie = item.media_type === 'movie' || item.release_date;
            const title = item.title || item.name;
            const date = (item.release_date || item.first_air_date || '').split('-')[0];
            const vote = item.vote_average ? ` • ⭐ ${item.vote_average.toFixed(1)}` : '';
            
            posterEl.classList.add('opacity-0');
            
            setTimeout(() => {
                posterEl.src = `${IMG_URL}${item.poster_path}`;
                titleEl.innerText = title;
                metaEl.innerText = `${isMovie ? 'Filme' : 'Série'} • ${date}${vote}`;
                
                posterEl.onload = () => {
                    posterEl.classList.remove('opacity-0');
                    updateThemeColor(posterEl);
                };
            }, 300);
        }

        function createCards(data, container) {
            container.innerHTML = '';
            data.slice(0, 10).forEach(item => {
                const card = document.createElement('div');
                card.className = 'movie-card';
                card.innerHTML = `<img src="${THUMB_URL}${item.poster_path}" class="w-full h-full object-cover" loading="lazy">`;
                card.onclick = () => {
                    setHero(item);
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                };
                container.appendChild(card);
            });
        }

        async function initApp() {
            moviesContainer.innerHTML = Array(5).fill('<div class="movie-card skeleton"></div>').join('');
            seriesContainer.innerHTML = Array(5).fill('<div class="movie-card skeleton"></div>').join('');

            const trending = await fetchTMDB('/trending/all/day');
            const popularMovies = await fetchTMDB('/movie/popular');
            const popularTV = await fetchTMDB('/tv/popular');

            if (trending && trending.results.length > 0) {
                setHero(trending.results[0]);
                createCards(popularMovies.results, moviesContainer);
                createCards(popularTV.results, seriesContainer);
            }
        }

        window.loadCategory = async (type) => {
            const pills = document.querySelectorAll('.filter-pill');
            pills.forEach(p => p.classList.remove('active'));
            event.target.classList.add('active');

            let endpoint = type === 'trending' ? '/trending/all/day' : `/${type}/popular`;
            const data = await fetchTMDB(endpoint);
            if (data) {
                setHero(data.results[0]);
                createCards(data.results, moviesContainer);
            }
        };

        window.onload = initApp;
    </script>
</body>
</html>
